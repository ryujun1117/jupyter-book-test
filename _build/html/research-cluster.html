
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>K-node &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'research-cluster';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Notebooks with MyST Markdown" href="markdown-notebooks.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="markdown.html">Markdown Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Content with notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">K-node</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fresearch-cluster.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/research-cluster.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>K-node</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p>トヨタ車をクラスタリング</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive/&#39;</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;google&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/content/drive/MyDrive/2024/技術計画/data/クルママスタ.csv&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-0beb3639-72ce-442a-b811-76d2a733f778" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carname</th>
      <th>min_cost</th>
      <th>max_cost</th>
      <th>body_color_cnt</th>
      <th>interior_color_cnt</th>
      <th>engine_type_cnt</th>
      <th>min_mileage</th>
      <th>body_l</th>
      <th>body_w</th>
      <th>body_h</th>
      <th>indoor_l</th>
      <th>indoor_w</th>
      <th>indoor_h</th>
      <th>passenger_num</th>
      <th>min_displacement</th>
      <th>min_mrr</th>
      <th>model</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>aqua</td>
      <td>1997000</td>
      <td>2598000.00</td>
      <td>13.00</td>
      <td>3.00</td>
      <td>1.00</td>
      <td>29.30</td>
      <td>4050.00</td>
      <td>1695.00</td>
      <td>1485.00</td>
      <td>1830.00</td>
      <td>1425.00</td>
      <td>1190.00</td>
      <td>5.00</td>
      <td>1.50</td>
      <td>4.90</td>
      <td>compact</td>
    </tr>
    <tr>
      <th>1</th>
      <td>corollasport</td>
      <td>2200000</td>
      <td>2890000.00</td>
      <td>9.00</td>
      <td>3.00</td>
      <td>2.00</td>
      <td>27.20</td>
      <td>4375.00</td>
      <td>1790.00</td>
      <td>1460.00</td>
      <td>1795.00</td>
      <td>1510.00</td>
      <td>1155.00</td>
      <td>5.00</td>
      <td>1.80</td>
      <td>5.10</td>
      <td>compact</td>
    </tr>
    <tr>
      <th>2</th>
      <td>new-corolla</td>
      <td>1990000</td>
      <td>2998000.00</td>
      <td>5.00</td>
      <td>2.00</td>
      <td>2.00</td>
      <td>25.30</td>
      <td>4495.00</td>
      <td>1745.00</td>
      <td>1435.00</td>
      <td>1830.00</td>
      <td>1510.00</td>
      <td>1160.00</td>
      <td>5.00</td>
      <td>1.50</td>
      <td>5.00</td>
      <td>compact</td>
    </tr>
    <tr>
      <th>3</th>
      <td>yaris</td>
      <td>1501000</td>
      <td>2694000.00</td>
      <td>11.00</td>
      <td>2.00</td>
      <td>2.00</td>
      <td>30.20</td>
      <td>3950.00</td>
      <td>1695.00</td>
      <td>1495.00</td>
      <td>1845.00</td>
      <td>1430.00</td>
      <td>1190.00</td>
      <td>5.00</td>
      <td>1.00</td>
      <td>4.80</td>
      <td>compact</td>
    </tr>
    <tr>
      <th>4</th>
      <td>roomy</td>
      <td>1566500</td>
      <td>2100000.00</td>
      <td>10.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>16.80</td>
      <td>3705.00</td>
      <td>1670.00</td>
      <td>1735.00</td>
      <td>2180.00</td>
      <td>1480.00</td>
      <td>1355.00</td>
      <td>5.00</td>
      <td>1.00</td>
      <td>4.60</td>
      <td>compact</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0beb3639-72ce-442a-b811-76d2a733f778')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0beb3639-72ce-442a-b811-76d2a733f778 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0beb3639-72ce-442a-b811-76d2a733f778');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-130afa15-81ad-499e-ab23-36d31fc305c5">
  <button class="colab-df-quickchart" onclick="quickchart('df-130afa15-81ad-499e-ab23-36d31fc305c5')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-130afa15-81ad-499e-ab23-36d31fc305c5 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;carname&#39;, &#39;min_cost&#39;, &#39;max_cost&#39;, &#39;body_color_cnt&#39;,
       &#39;interior_color_cnt&#39;, &#39;engine_type_cnt&#39;, &#39;min_mileage&#39;, &#39;body_l&#39;,
       &#39;body_w&#39;, &#39;body_h&#39;, &#39;indoor_l&#39;, &#39;indoor_w&#39;, &#39;indoor_h&#39;, &#39;passenger_num&#39;,
       &#39;min_displacement&#39;, &#39;min_mrr&#39;, &#39;model&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 型変換</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="k">if</span> <span class="n">col</span> <span class="o">==</span> <span class="s2">&quot;min_mileage&quot;</span> <span class="ow">or</span> <span class="n">col</span> <span class="o">==</span> <span class="s2">&quot;min_displacement&quot;</span> <span class="ow">or</span> <span class="n">col</span> <span class="o">==</span> <span class="s2">&quot;min_mrr&quot;</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">col</span> <span class="o">==</span> <span class="s2">&quot;carname&quot;</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">col</span> <span class="o">==</span> <span class="s2">&quot;model&quot;</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>carname                 object
min_cost                 int64
max_cost                 int64
body_color_cnt           int64
interior_color_cnt       int64
engine_type_cnt          int64
min_mileage            float64
body_l                   int64
body_w                   int64
body_h                   int64
indoor_l                 int64
indoor_w                 int64
indoor_h                 int64
passenger_num            int64
min_displacement       float64
min_mrr                float64
model                 category
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># EDA</span>
<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-bb296c0c-1cb4-4785-b8ec-81f1b74207a4" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min_cost</th>
      <th>max_cost</th>
      <th>body_color_cnt</th>
      <th>interior_color_cnt</th>
      <th>engine_type_cnt</th>
      <th>min_mileage</th>
      <th>body_l</th>
      <th>body_w</th>
      <th>body_h</th>
      <th>indoor_l</th>
      <th>indoor_w</th>
      <th>indoor_h</th>
      <th>passenger_num</th>
      <th>min_displacement</th>
      <th>min_mrr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>35.00</td>
      <td>35.00</td>
      <td>35.00</td>
      <td>35.00</td>
      <td>35.00</td>
      <td>35.00</td>
      <td>35.00</td>
      <td>35.00</td>
      <td>35.00</td>
      <td>35.00</td>
      <td>35.00</td>
      <td>35.00</td>
      <td>35.00</td>
      <td>35.00</td>
      <td>35.00</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3745757.14</td>
      <td>4945765.71</td>
      <td>6.63</td>
      <td>1.97</td>
      <td>1.66</td>
      <td>23.31</td>
      <td>4517.43</td>
      <td>1785.43</td>
      <td>1616.71</td>
      <td>2096.29</td>
      <td>1508.43</td>
      <td>1222.43</td>
      <td>5.26</td>
      <td>2.01</td>
      <td>5.19</td>
    </tr>
    <tr>
      <th>std</th>
      <td>3336920.54</td>
      <td>3398898.31</td>
      <td>2.67</td>
      <td>1.18</td>
      <td>0.59</td>
      <td>22.43</td>
      <td>493.03</td>
      <td>113.94</td>
      <td>235.93</td>
      <td>569.90</td>
      <td>98.37</td>
      <td>107.57</td>
      <td>1.42</td>
      <td>1.09</td>
      <td>0.78</td>
    </tr>
    <tr>
      <th>min</th>
      <td>860200.00</td>
      <td>1364000.00</td>
      <td>2.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>8.00</td>
      <td>3395.00</td>
      <td>1475.00</td>
      <td>1280.00</td>
      <td>910.00</td>
      <td>1250.00</td>
      <td>1040.00</td>
      <td>2.00</td>
      <td>0.00</td>
      <td>1.50</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1990000.00</td>
      <td>2944000.00</td>
      <td>5.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>13.00</td>
      <td>4262.50</td>
      <td>1712.50</td>
      <td>1460.00</td>
      <td>1817.50</td>
      <td>1435.00</td>
      <td>1160.00</td>
      <td>5.00</td>
      <td>1.50</td>
      <td>4.95</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2750000.00</td>
      <td>3960000.00</td>
      <td>6.00</td>
      <td>2.00</td>
      <td>2.00</td>
      <td>21.60</td>
      <td>4495.00</td>
      <td>1790.00</td>
      <td>1500.00</td>
      <td>1890.00</td>
      <td>1510.00</td>
      <td>1200.00</td>
      <td>5.00</td>
      <td>1.80</td>
      <td>5.20</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4897500.00</td>
      <td>5916500.00</td>
      <td>8.00</td>
      <td>2.00</td>
      <td>2.00</td>
      <td>25.30</td>
      <td>4900.00</td>
      <td>1865.00</td>
      <td>1785.00</td>
      <td>2350.00</td>
      <td>1550.00</td>
      <td>1255.00</td>
      <td>5.00</td>
      <td>2.50</td>
      <td>5.55</td>
    </tr>
    <tr>
      <th>max</th>
      <td>20080000.00</td>
      <td>20080000.00</td>
      <td>13.00</td>
      <td>7.00</td>
      <td>3.00</td>
      <td>146.00</td>
      <td>5380.00</td>
      <td>1980.00</td>
      <td>2285.00</td>
      <td>3525.00</td>
      <td>1735.00</td>
      <td>1565.00</td>
      <td>10.00</td>
      <td>5.70</td>
      <td>6.30</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-bb296c0c-1cb4-4785-b8ec-81f1b74207a4')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-bb296c0c-1cb4-4785-b8ec-81f1b74207a4 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-bb296c0c-1cb4-4785-b8ec-81f1b74207a4');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-39190b3c-145a-4404-b309-fa503dd394b8">
  <button class="colab-df-quickchart" onclick="quickchart('df-39190b3c-145a-4404-b309-fa503dd394b8')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-39190b3c-145a-4404-b309-fa503dd394b8 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 車型別</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-139-80e8c7e29ec3&gt;:2: FutureWarning:

The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
</pre></div>
</div>
<div class="output text_html">
  <div id="df-b272f443-3891-40d7-8552-c992f11290e5" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min_cost</th>
      <th>max_cost</th>
      <th>body_color_cnt</th>
      <th>interior_color_cnt</th>
      <th>engine_type_cnt</th>
      <th>min_mileage</th>
      <th>body_l</th>
      <th>body_w</th>
      <th>body_h</th>
      <th>indoor_l</th>
      <th>indoor_w</th>
      <th>indoor_h</th>
      <th>passenger_num</th>
      <th>min_displacement</th>
      <th>min_mrr</th>
    </tr>
    <tr>
      <th>model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>century</th>
      <td>20080000.00</td>
      <td>20080000.00</td>
      <td>4.00</td>
      <td>7.00</td>
      <td>1.00</td>
      <td>12.40</td>
      <td>5335.00</td>
      <td>1930.00</td>
      <td>1505.00</td>
      <td>2165.00</td>
      <td>1605.00</td>
      <td>1185.00</td>
      <td>5.00</td>
      <td>5.00</td>
      <td>5.90</td>
    </tr>
    <tr>
      <th>compact</th>
      <td>1850900.00</td>
      <td>2656000.00</td>
      <td>9.60</td>
      <td>2.20</td>
      <td>1.60</td>
      <td>25.76</td>
      <td>4115.00</td>
      <td>1719.00</td>
      <td>1522.00</td>
      <td>1896.00</td>
      <td>1471.00</td>
      <td>1210.00</td>
      <td>5.00</td>
      <td>1.36</td>
      <td>4.88</td>
    </tr>
    <tr>
      <th>kei</th>
      <td>860200.00</td>
      <td>1364000.00</td>
      <td>7.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>23.20</td>
      <td>3395.00</td>
      <td>1475.00</td>
      <td>1500.00</td>
      <td>2025.00</td>
      <td>1345.00</td>
      <td>1240.00</td>
      <td>4.00</td>
      <td>0.66</td>
      <td>4.40</td>
    </tr>
    <tr>
      <th>mini-ban</th>
      <td>4146800.00</td>
      <td>5624171.43</td>
      <td>5.29</td>
      <td>2.00</td>
      <td>1.71</td>
      <td>17.20</td>
      <td>4902.86</td>
      <td>1815.00</td>
      <td>1948.57</td>
      <td>2997.14</td>
      <td>1602.86</td>
      <td>1383.57</td>
      <td>7.00</td>
      <td>2.21</td>
      <td>5.51</td>
    </tr>
    <tr>
      <th>sedan</th>
      <td>3421520.00</td>
      <td>4613400.00</td>
      <td>6.00</td>
      <td>1.60</td>
      <td>1.60</td>
      <td>49.48</td>
      <td>4676.00</td>
      <td>1789.00</td>
      <td>1448.00</td>
      <td>1886.00</td>
      <td>1514.00</td>
      <td>1162.00</td>
      <td>5.00</td>
      <td>2.30</td>
      <td>4.50</td>
    </tr>
    <tr>
      <th>sport</th>
      <td>3638640.00</td>
      <td>4626840.00</td>
      <td>6.00</td>
      <td>2.00</td>
      <td>1.00</td>
      <td>13.46</td>
      <td>4089.00</td>
      <td>1754.00</td>
      <td>1364.00</td>
      <td>1435.00</td>
      <td>1426.00</td>
      <td>1098.00</td>
      <td>3.40</td>
      <td>1.63</td>
      <td>5.18</td>
    </tr>
    <tr>
      <th>suv</th>
      <td>3638888.89</td>
      <td>5269888.89</td>
      <td>7.22</td>
      <td>1.67</td>
      <td>2.11</td>
      <td>18.20</td>
      <td>4640.56</td>
      <td>1847.78</td>
      <td>1703.89</td>
      <td>2041.67</td>
      <td>1514.44</td>
      <td>1218.33</td>
      <td>5.44</td>
      <td>2.18</td>
      <td>5.57</td>
    </tr>
    <tr>
      <th>wagon</th>
      <td>1914200.00</td>
      <td>2689200.00</td>
      <td>5.50</td>
      <td>1.50</td>
      <td>2.00</td>
      <td>26.35</td>
      <td>4447.50</td>
      <td>1720.00</td>
      <td>1467.50</td>
      <td>1870.00</td>
      <td>1470.00</td>
      <td>1180.00</td>
      <td>5.00</td>
      <td>1.50</td>
      <td>4.95</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b272f443-3891-40d7-8552-c992f11290e5')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b272f443-3891-40d7-8552-c992f11290e5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b272f443-3891-40d7-8552-c992f11290e5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-41059ef1-8fae-4049-b5a9-206d4d3bf0bb">
  <button class="colab-df-quickchart" onclick="quickchart('df-41059ef1-8fae-4049-b5a9-206d4d3bf0bb')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-41059ef1-8fae-4049-b5a9-206d4d3bf0bb button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;carname&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_cost&#39;</span><span class="p">,</span> <span class="s1">&#39;min_mileage&#39;</span><span class="p">,</span><span class="s1">&#39;body_l&#39;</span><span class="p">,</span><span class="s1">&#39;body_w&#39;</span><span class="p">,</span><span class="s1">&#39;body_h&#39;</span><span class="p">,</span>
            <span class="s1">&#39;indoor_l&#39;</span><span class="p">,</span><span class="s1">&#39;indoor_w&#39;</span><span class="p">,</span><span class="s1">&#39;indoor_h&#39;</span><span class="p">,</span><span class="s1">&#39;passenger_num&#39;</span><span class="p">,</span><span class="s1">&#39;min_displacement&#39;</span><span class="p">,</span><span class="s1">&#39;min_mrr&#39;</span><span class="p">,</span><span class="s1">&#39;model&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 特徴量設計</span>
<span class="c1"># 平均価格</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;mean_cost&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;min_cost&quot;</span><span class="p">,</span> <span class="s2">&quot;max_cost&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">t_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_list</span><span class="p">]</span>
<span class="n">t_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-1ad1506c-3ad8-48df-9e33-8c0626ce3418" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carname</th>
      <th>mean_cost</th>
      <th>min_mileage</th>
      <th>body_l</th>
      <th>body_w</th>
      <th>body_h</th>
      <th>indoor_l</th>
      <th>indoor_w</th>
      <th>indoor_h</th>
      <th>passenger_num</th>
      <th>min_displacement</th>
      <th>min_mrr</th>
      <th>model</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>aqua</td>
      <td>2297500.00</td>
      <td>29.30</td>
      <td>4050</td>
      <td>1695</td>
      <td>1485</td>
      <td>1830</td>
      <td>1425</td>
      <td>1190</td>
      <td>5</td>
      <td>1.50</td>
      <td>4.90</td>
      <td>compact</td>
    </tr>
    <tr>
      <th>1</th>
      <td>corollasport</td>
      <td>2545000.00</td>
      <td>27.20</td>
      <td>4375</td>
      <td>1790</td>
      <td>1460</td>
      <td>1795</td>
      <td>1510</td>
      <td>1155</td>
      <td>5</td>
      <td>1.80</td>
      <td>5.10</td>
      <td>compact</td>
    </tr>
    <tr>
      <th>2</th>
      <td>new-corolla</td>
      <td>2494000.00</td>
      <td>25.30</td>
      <td>4495</td>
      <td>1745</td>
      <td>1435</td>
      <td>1830</td>
      <td>1510</td>
      <td>1160</td>
      <td>5</td>
      <td>1.50</td>
      <td>5.00</td>
      <td>compact</td>
    </tr>
    <tr>
      <th>3</th>
      <td>yaris</td>
      <td>2097500.00</td>
      <td>30.20</td>
      <td>3950</td>
      <td>1695</td>
      <td>1495</td>
      <td>1845</td>
      <td>1430</td>
      <td>1190</td>
      <td>5</td>
      <td>1.00</td>
      <td>4.80</td>
      <td>compact</td>
    </tr>
    <tr>
      <th>4</th>
      <td>roomy</td>
      <td>1833250.00</td>
      <td>16.80</td>
      <td>3705</td>
      <td>1670</td>
      <td>1735</td>
      <td>2180</td>
      <td>1480</td>
      <td>1355</td>
      <td>5</td>
      <td>1.00</td>
      <td>4.60</td>
      <td>compact</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1ad1506c-3ad8-48df-9e33-8c0626ce3418')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1ad1506c-3ad8-48df-9e33-8c0626ce3418 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1ad1506c-3ad8-48df-9e33-8c0626ce3418');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-061e452c-97a2-4f70-95f7-f265a775a3a9">
  <button class="colab-df-quickchart" onclick="quickchart('df-061e452c-97a2-4f70-95f7-f265a775a3a9')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-061e452c-97a2-4f70-95f7-f265a775a3a9 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-5090dac8-4945-4af4-97d8-83d462f087a5" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_cost</th>
      <th>min_mileage</th>
      <th>body_l</th>
      <th>body_w</th>
      <th>body_h</th>
      <th>indoor_l</th>
      <th>indoor_w</th>
      <th>indoor_h</th>
      <th>passenger_num</th>
      <th>min_displacement</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2297500.00</td>
      <td>29.30</td>
      <td>4050</td>
      <td>1695</td>
      <td>1485</td>
      <td>1830</td>
      <td>1425</td>
      <td>1190</td>
      <td>5</td>
      <td>1.50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2545000.00</td>
      <td>27.20</td>
      <td>4375</td>
      <td>1790</td>
      <td>1460</td>
      <td>1795</td>
      <td>1510</td>
      <td>1155</td>
      <td>5</td>
      <td>1.80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2494000.00</td>
      <td>25.30</td>
      <td>4495</td>
      <td>1745</td>
      <td>1435</td>
      <td>1830</td>
      <td>1510</td>
      <td>1160</td>
      <td>5</td>
      <td>1.50</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5090dac8-4945-4af4-97d8-83d462f087a5')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5090dac8-4945-4af4-97d8-83d462f087a5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5090dac8-4945-4af4-97d8-83d462f087a5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-2a0a9e60-001f-4f12-b002-ac51dc6c15b5">
  <button class="colab-df-quickchart" onclick="quickchart('df-2a0a9e60-001f-4f12-b002-ac51dc6c15b5')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-2a0a9e60-001f-4f12-b002-ac51dc6c15b5 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># t-SNE</span>
<span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">TSNE</span>

<span class="n">n_components</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">perplexity</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">early_exaggeration</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">init</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span>
<span class="n">random_state</span> <span class="o">=</span> <span class="mi">2018</span>

<span class="n">tSNE</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">n_components</span> <span class="o">=</span> <span class="n">n_components</span><span class="p">,</span>
            <span class="n">learning_rate</span> <span class="o">=</span> <span class="n">learning_rate</span><span class="p">,</span>
            <span class="n">perplexity</span><span class="o">=</span><span class="n">perplexity</span><span class="p">,</span>
            <span class="n">early_exaggeration</span> <span class="o">=</span> <span class="n">early_exaggeration</span><span class="p">,</span>
            <span class="n">init</span> <span class="o">=</span> <span class="n">init</span><span class="p">,</span>
            <span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span><span class="p">)</span>

<span class="n">X_train_tSNE</span> <span class="o">=</span> <span class="n">tSNE</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">t_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="n">X_train_tSNE</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">X_train_tSNE</span><span class="p">)</span>

<span class="c1"># scatterPlot(X_train_tSNE)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">X_train_tSNE</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>
<span class="n">result_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;First Vector&quot;</span><span class="p">,</span> <span class="s2">&quot;Second Vector&quot;</span><span class="p">,</span> <span class="s2">&quot;Label&quot;</span><span class="p">]</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;First Vector&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Second Vector&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Label&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">result_df</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Separation of Observations using &quot;</span> <span class="o">+</span> <span class="s2">&quot;tSNE&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Separation of Observations using tSNE&#39;)
</pre></div>
</div>
<img alt="_images/c14354dff1addb71d78e8d43cf5898fdca01bbc062a004578b11fef5cb61ad06.png" src="_images/c14354dff1addb71d78e8d43cf5898fdca01bbc062a004578b11fef5cb61ad06.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Principal Component Analysis</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

<span class="n">n_components</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">whiten</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">random_state</span> <span class="o">=</span> <span class="mi">2018</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">,</span> <span class="n">whiten</span><span class="o">=</span><span class="n">whiten</span><span class="p">,</span>
          <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>

<span class="n">X_train_PCA</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">t_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="n">X_train_PCA</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">X_train_PCA</span><span class="p">)</span>
<span class="n">X_train_PCA</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-0548c609-0707-4e7b-9bd7-45d31808ab95" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-2048261.47</td>
      <td>-340.28</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1800761.44</td>
      <td>-239.57</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1851761.43</td>
      <td>-164.26</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-2248261.48</td>
      <td>-354.54</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-2512511.49</td>
      <td>-68.72</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0548c609-0707-4e7b-9bd7-45d31808ab95')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0548c609-0707-4e7b-9bd7-45d31808ab95 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0548c609-0707-4e7b-9bd7-45d31808ab95');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-5200b2fc-5179-4d85-a657-0583aedf77b3">
  <button class="colab-df-quickchart" onclick="quickchart('df-5200b2fc-5179-4d85-a657-0583aedf77b3')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-5200b2fc-5179-4d85-a657-0583aedf77b3 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># k-means - Inertia as the number of clusters varies</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>

<span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_init</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">max_iter</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">0.0001</span>
<span class="n">random_state</span> <span class="o">=</span> <span class="mi">2018</span>
<span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">kMeans_inertia</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">21</span><span class="p">),</span>
                              <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;inertia&quot;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">n_clusters</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">21</span><span class="p">):</span>
    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="n">n_init</span><span class="p">,</span>
                    <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>

    <span class="n">cutoff</span> <span class="o">=</span> <span class="mi">99</span>
    <span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_PCA</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">cutoff</span><span class="p">])</span>
    <span class="n">kMeans_inertia</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">n_clusters</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kMeans_inertia</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/f1c0012db89554acfdf29c94832787f7c79d2559f9ed2be5b396dfb4bb82fc9e.png" src="_images/f1c0012db89554acfdf29c94832787f7c79d2559f9ed2be5b396dfb4bb82fc9e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># クラスタリング結果の評価</span>
<span class="k">def</span> <span class="nf">analyzeCluster</span><span class="p">(</span><span class="n">clusterDF</span><span class="p">,</span> <span class="n">labelsDF</span><span class="p">):</span>
    <span class="n">countByCluster</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">clusterDF</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
    <span class="n">countByCluster</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">countByCluster</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">,</span> <span class="s1">&#39;clusterCount&#39;</span><span class="p">]</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">labelsDF</span><span class="p">,</span> <span class="n">clusterDF</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">preds</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;trueLabel&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster&#39;</span><span class="p">]</span>

    <span class="n">countByLabel</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">preds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;trueLabel&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>

    <span class="n">countMostFreq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">preds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;cluster&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">countMostFreq</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">countMostFreq</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">,</span> <span class="s1">&#39;countMostFrequent&#39;</span><span class="p">]</span>

    <span class="n">accuracyDF</span> <span class="o">=</span> <span class="n">countMostFreq</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">countByCluster</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;cluster&quot;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;cluster&#39;</span><span class="p">)</span>
    <span class="n">overallAccuracy</span> <span class="o">=</span> <span class="n">accuracyDF</span><span class="o">.</span><span class="n">countMostFrequent</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">accuracyDF</span><span class="o">.</span><span class="n">clusterCount</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="n">accuracyByLabel</span> <span class="o">=</span> <span class="n">accuracyDF</span><span class="o">.</span><span class="n">countMostFrequent</span> <span class="o">/</span> <span class="n">accuracyDF</span><span class="o">.</span><span class="n">clusterCount</span>

    <span class="k">return</span> <span class="n">countByCluster</span><span class="p">,</span> <span class="n">countByLabel</span><span class="p">,</span> <span class="n">countMostFreq</span><span class="p">,</span> <span class="n">accuracyDF</span><span class="p">,</span> <span class="n">overallAccuracy</span><span class="p">,</span> <span class="n">accuracyByLabel</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="n">countByCluster</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">n_init</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">max_iter</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">0.0001</span>
<span class="n">random_state</span> <span class="o">=</span> <span class="mi">2018</span>
<span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">kMeans_inertia</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">21</span><span class="p">),</span>
                              <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;inertia&quot;</span><span class="p">])</span>
<span class="n">overallAccuracy_kMeansDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">21</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;overallAccuracy&#39;</span><span class="p">])</span>

<span class="k">for</span> <span class="n">n_clusters</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">21</span><span class="p">):</span>
    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="n">n_init</span><span class="p">,</span>
                    <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>

    <span class="n">cutoff</span> <span class="o">=</span> <span class="mi">99</span>
    <span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_PCA</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">cutoff</span><span class="p">])</span>
    <span class="n">kMeans_inertia</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">n_clusters</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span>

    <span class="n">X_train_kmeansClustered</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_PCA</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">cutoff</span><span class="p">])</span>
    <span class="n">X_train_kmeansClustered</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">X_train_kmeansClustered</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">])</span>

    <span class="n">countByCluster_kMeans</span><span class="p">,</span> <span class="n">countByLabel_kMeans</span><span class="p">,</span> <span class="n">countMostFreq_kMeans</span><span class="p">,</span> \
    <span class="n">accuracyDF_kMeans</span><span class="p">,</span> <span class="n">overallAccuracy_kMeans</span><span class="p">,</span> <span class="n">accuracyByLabel_kMeans</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="n">countByCluster</span>\
    <span class="o">=</span> <span class="n">analyzeCluster</span><span class="p">(</span><span class="n">X_train_kmeansClustered</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">])</span>

    <span class="n">overallAccuracy_kMeansDF</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">n_clusters</span><span class="p">]</span> <span class="o">=</span> <span class="n">overallAccuracy_kMeans</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot accuracy</span>
<span class="n">overallAccuracy_kMeansDF</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/a63327df2ddbf6087181f398d7c905782f8c9324139bc4bb12ca03522202ae55.png" src="_images/a63327df2ddbf6087181f398d7c905782f8c9324139bc4bb12ca03522202ae55.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># k-means</span>
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="n">n_init</span><span class="p">,</span>
                <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>

<span class="n">cutoff</span> <span class="o">=</span> <span class="mi">99</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_PCA</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">cutoff</span><span class="p">])</span>
<span class="n">kMeans_inertia</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">n_clusters</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span>

<span class="n">df</span><span class="p">[</span><span class="s2">&quot;cls&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_PCA</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">cutoff</span><span class="p">])</span>
<span class="n">X_train_PCA</span><span class="p">[</span><span class="s1">&#39;cls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_PCA</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">cutoff</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-72d8a0bc-3224-478e-9f6b-79dd1336f706" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carname</th>
      <th>min_cost</th>
      <th>max_cost</th>
      <th>body_color_cnt</th>
      <th>interior_color_cnt</th>
      <th>engine_type_cnt</th>
      <th>min_mileage</th>
      <th>body_l</th>
      <th>body_w</th>
      <th>body_h</th>
      <th>indoor_l</th>
      <th>indoor_w</th>
      <th>indoor_h</th>
      <th>passenger_num</th>
      <th>min_displacement</th>
      <th>min_mrr</th>
      <th>model</th>
      <th>mean_cost</th>
      <th>cls</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>aqua</td>
      <td>1997000</td>
      <td>2598000</td>
      <td>13</td>
      <td>3</td>
      <td>1</td>
      <td>29.30</td>
      <td>4050</td>
      <td>1695</td>
      <td>1485</td>
      <td>1830</td>
      <td>1425</td>
      <td>1190</td>
      <td>5</td>
      <td>1.50</td>
      <td>4.90</td>
      <td>compact</td>
      <td>2297500.00</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>corollasport</td>
      <td>2200000</td>
      <td>2890000</td>
      <td>9</td>
      <td>3</td>
      <td>2</td>
      <td>27.20</td>
      <td>4375</td>
      <td>1790</td>
      <td>1460</td>
      <td>1795</td>
      <td>1510</td>
      <td>1155</td>
      <td>5</td>
      <td>1.80</td>
      <td>5.10</td>
      <td>compact</td>
      <td>2545000.00</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>new-corolla</td>
      <td>1990000</td>
      <td>2998000</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>25.30</td>
      <td>4495</td>
      <td>1745</td>
      <td>1435</td>
      <td>1830</td>
      <td>1510</td>
      <td>1160</td>
      <td>5</td>
      <td>1.50</td>
      <td>5.00</td>
      <td>compact</td>
      <td>2494000.00</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>yaris</td>
      <td>1501000</td>
      <td>2694000</td>
      <td>11</td>
      <td>2</td>
      <td>2</td>
      <td>30.20</td>
      <td>3950</td>
      <td>1695</td>
      <td>1495</td>
      <td>1845</td>
      <td>1430</td>
      <td>1190</td>
      <td>5</td>
      <td>1.00</td>
      <td>4.80</td>
      <td>compact</td>
      <td>2097500.00</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>roomy</td>
      <td>1566500</td>
      <td>2100000</td>
      <td>10</td>
      <td>1</td>
      <td>1</td>
      <td>16.80</td>
      <td>3705</td>
      <td>1670</td>
      <td>1735</td>
      <td>2180</td>
      <td>1480</td>
      <td>1355</td>
      <td>5</td>
      <td>1.00</td>
      <td>4.60</td>
      <td>compact</td>
      <td>1833250.00</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alphard</td>
      <td>5400000</td>
      <td>8720000</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>16.50</td>
      <td>4995</td>
      <td>1850</td>
      <td>1935</td>
      <td>3005</td>
      <td>1660</td>
      <td>1360</td>
      <td>7</td>
      <td>2.50</td>
      <td>5.90</td>
      <td>mini-ban</td>
      <td>7060000.00</td>
      <td>2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>vellfire</td>
      <td>6550000</td>
      <td>8920000</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>16.50</td>
      <td>4995</td>
      <td>1850</td>
      <td>1945</td>
      <td>3005</td>
      <td>1660</td>
      <td>1360</td>
      <td>7</td>
      <td>2.40</td>
      <td>5.90</td>
      <td>mini-ban</td>
      <td>7735000.00</td>
      <td>5</td>
    </tr>
    <tr>
      <th>7</th>
      <td>voxy</td>
      <td>3090000</td>
      <td>3960000</td>
      <td>6</td>
      <td>1</td>
      <td>2</td>
      <td>22.00</td>
      <td>4695</td>
      <td>1730</td>
      <td>1895</td>
      <td>2805</td>
      <td>1470</td>
      <td>1405</td>
      <td>7</td>
      <td>1.80</td>
      <td>5.50</td>
      <td>mini-ban</td>
      <td>3525000.00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>granace</td>
      <td>6421000</td>
      <td>6721000</td>
      <td>4</td>
      <td>4</td>
      <td>1</td>
      <td>10.00</td>
      <td>5300</td>
      <td>1970</td>
      <td>1990</td>
      <td>3290</td>
      <td>1735</td>
      <td>1290</td>
      <td>6</td>
      <td>2.80</td>
      <td>5.60</td>
      <td>mini-ban</td>
      <td>6571000.00</td>
      <td>2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>sienta</td>
      <td>1950000</td>
      <td>3108000</td>
      <td>9</td>
      <td>3</td>
      <td>2</td>
      <td>25.30</td>
      <td>4260</td>
      <td>1695</td>
      <td>1695</td>
      <td>2545</td>
      <td>1530</td>
      <td>1300</td>
      <td>5</td>
      <td>1.50</td>
      <td>5.00</td>
      <td>mini-ban</td>
      <td>2529000.00</td>
      <td>7</td>
    </tr>
    <tr>
      <th>10</th>
      <td>noah</td>
      <td>2670000</td>
      <td>3890000</td>
      <td>6</td>
      <td>1</td>
      <td>2</td>
      <td>22.00</td>
      <td>4695</td>
      <td>1730</td>
      <td>1895</td>
      <td>2805</td>
      <td>1470</td>
      <td>1405</td>
      <td>7</td>
      <td>1.80</td>
      <td>5.50</td>
      <td>mini-ban</td>
      <td>3280000.00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>hiacewagon</td>
      <td>2946600</td>
      <td>4050200</td>
      <td>7</td>
      <td>1</td>
      <td>1</td>
      <td>8.10</td>
      <td>5380</td>
      <td>1880</td>
      <td>2285</td>
      <td>3525</td>
      <td>1695</td>
      <td>1565</td>
      <td>10</td>
      <td>2.70</td>
      <td>5.20</td>
      <td>mini-ban</td>
      <td>3498400.00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>camry</td>
      <td>3495000</td>
      <td>4682000</td>
      <td>7</td>
      <td>1</td>
      <td>1</td>
      <td>21.60</td>
      <td>4910</td>
      <td>1840</td>
      <td>1445</td>
      <td>2010</td>
      <td>1535</td>
      <td>1185</td>
      <td>5</td>
      <td>2.50</td>
      <td>1.50</td>
      <td>sedan</td>
      <td>4088500.00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>corolla</td>
      <td>1990000</td>
      <td>2998000</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>25.30</td>
      <td>4495</td>
      <td>1745</td>
      <td>1435</td>
      <td>1830</td>
      <td>1510</td>
      <td>1160</td>
      <td>5</td>
      <td>5.70</td>
      <td>5.00</td>
      <td>sedan</td>
      <td>2494000.00</td>
      <td>7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>corollaaxio</td>
      <td>1611600</td>
      <td>2177000</td>
      <td>4</td>
      <td>1</td>
      <td>2</td>
      <td>27.80</td>
      <td>4400</td>
      <td>1695</td>
      <td>1460</td>
      <td>1945</td>
      <td>1430</td>
      <td>1200</td>
      <td>5</td>
      <td>1.50</td>
      <td>4.90</td>
      <td>sedan</td>
      <td>1894300.00</td>
      <td>3</td>
    </tr>
    <tr>
      <th>15</th>
      <td>century</td>
      <td>20080000</td>
      <td>20080000</td>
      <td>4</td>
      <td>7</td>
      <td>1</td>
      <td>12.40</td>
      <td>5335</td>
      <td>1930</td>
      <td>1505</td>
      <td>2165</td>
      <td>1605</td>
      <td>1185</td>
      <td>5</td>
      <td>5.00</td>
      <td>5.90</td>
      <td>century</td>
      <td>20080000.00</td>
      <td>1</td>
    </tr>
    <tr>
      <th>16</th>
      <td>prius</td>
      <td>2750000</td>
      <td>4600000</td>
      <td>6</td>
      <td>2</td>
      <td>2</td>
      <td>26.70</td>
      <td>4600</td>
      <td>1780</td>
      <td>1430</td>
      <td>1840</td>
      <td>1500</td>
      <td>1130</td>
      <td>5</td>
      <td>1.80</td>
      <td>5.30</td>
      <td>sedan</td>
      <td>3675000.00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>mirai</td>
      <td>7261000</td>
      <td>8610000</td>
      <td>8</td>
      <td>2</td>
      <td>1</td>
      <td>146.00</td>
      <td>4975</td>
      <td>1885</td>
      <td>1470</td>
      <td>1805</td>
      <td>1595</td>
      <td>1135</td>
      <td>5</td>
      <td>0.00</td>
      <td>5.80</td>
      <td>sedan</td>
      <td>7935500.00</td>
      <td>5</td>
    </tr>
    <tr>
      <th>18</th>
      <td>corollatouring</td>
      <td>2070000</td>
      <td>3048000</td>
      <td>7</td>
      <td>2</td>
      <td>2</td>
      <td>24.90</td>
      <td>4495</td>
      <td>1745</td>
      <td>1460</td>
      <td>1795</td>
      <td>1510</td>
      <td>1160</td>
      <td>5</td>
      <td>1.50</td>
      <td>5.00</td>
      <td>wagon</td>
      <td>2559000.00</td>
      <td>7</td>
    </tr>
    <tr>
      <th>19</th>
      <td>corollafielder</td>
      <td>1758400</td>
      <td>2330400</td>
      <td>4</td>
      <td>1</td>
      <td>2</td>
      <td>27.80</td>
      <td>4400</td>
      <td>1695</td>
      <td>1475</td>
      <td>1945</td>
      <td>1430</td>
      <td>1200</td>
      <td>5</td>
      <td>1.50</td>
      <td>4.90</td>
      <td>wagon</td>
      <td>2044400.00</td>
      <td>3</td>
    </tr>
    <tr>
      <th>20</th>
      <td>corollacross</td>
      <td>2184000</td>
      <td>3459000</td>
      <td>11</td>
      <td>2</td>
      <td>2</td>
      <td>24.50</td>
      <td>4490</td>
      <td>1825</td>
      <td>1620</td>
      <td>1800</td>
      <td>1505</td>
      <td>1260</td>
      <td>5</td>
      <td>1.80</td>
      <td>5.20</td>
      <td>suv</td>
      <td>2821500.00</td>
      <td>7</td>
    </tr>
    <tr>
      <th>21</th>
      <td>crown</td>
      <td>7300000</td>
      <td>8300000</td>
      <td>6</td>
      <td>2</td>
      <td>2</td>
      <td>18.00</td>
      <td>5030</td>
      <td>1890</td>
      <td>1475</td>
      <td>1970</td>
      <td>1595</td>
      <td>1135</td>
      <td>5</td>
      <td>2.50</td>
      <td>5.70</td>
      <td>suv</td>
      <td>7800000.00</td>
      <td>5</td>
    </tr>
    <tr>
      <th>22</th>
      <td>harrier</td>
      <td>3128000</td>
      <td>6200000</td>
      <td>7</td>
      <td>2</td>
      <td>3</td>
      <td>21.60</td>
      <td>4740</td>
      <td>1855</td>
      <td>1660</td>
      <td>1880</td>
      <td>1520</td>
      <td>1215</td>
      <td>5</td>
      <td>2.00</td>
      <td>5.50</td>
      <td>suv</td>
      <td>4664000.00</td>
      <td>4</td>
    </tr>
    <tr>
      <th>23</th>
      <td>yariscross</td>
      <td>1907000</td>
      <td>3156000</td>
      <td>11</td>
      <td>1</td>
      <td>2</td>
      <td>25.00</td>
      <td>4200</td>
      <td>1765</td>
      <td>1590</td>
      <td>1845</td>
      <td>1430</td>
      <td>1205</td>
      <td>5</td>
      <td>1.50</td>
      <td>5.30</td>
      <td>suv</td>
      <td>2531500.00</td>
      <td>7</td>
    </tr>
    <tr>
      <th>24</th>
      <td>raize</td>
      <td>1717000</td>
      <td>2338000</td>
      <td>11</td>
      <td>1</td>
      <td>2</td>
      <td>28.00</td>
      <td>3995</td>
      <td>1695</td>
      <td>1620</td>
      <td>1955</td>
      <td>1420</td>
      <td>1250</td>
      <td>5</td>
      <td>1.00</td>
      <td>4.90</td>
      <td>suv</td>
      <td>2027500.00</td>
      <td>3</td>
    </tr>
    <tr>
      <th>25</th>
      <td>rav4</td>
      <td>2938000</td>
      <td>5633000</td>
      <td>6</td>
      <td>2</td>
      <td>3</td>
      <td>20.30</td>
      <td>4610</td>
      <td>1865</td>
      <td>1690</td>
      <td>1890</td>
      <td>1515</td>
      <td>1230</td>
      <td>5</td>
      <td>2.00</td>
      <td>5.50</td>
      <td>suv</td>
      <td>4285500.00</td>
      <td>4</td>
    </tr>
    <tr>
      <th>26</th>
      <td>landcruiser300</td>
      <td>5100000</td>
      <td>8000000</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>8.00</td>
      <td>4985</td>
      <td>1980</td>
      <td>1925</td>
      <td>2755</td>
      <td>1640</td>
      <td>1190</td>
      <td>7</td>
      <td>3.30</td>
      <td>5.90</td>
      <td>suv</td>
      <td>6550000.00</td>
      <td>2</td>
    </tr>
    <tr>
      <th>27</th>
      <td>landcruiser70</td>
      <td>4800000</td>
      <td>4800000</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>10.10</td>
      <td>4890</td>
      <td>1870</td>
      <td>1920</td>
      <td>1760</td>
      <td>1440</td>
      <td>1240</td>
      <td>5</td>
      <td>2.80</td>
      <td>6.30</td>
      <td>suv</td>
      <td>4800000.00</td>
      <td>4</td>
    </tr>
    <tr>
      <th>28</th>
      <td>landcruiserprado</td>
      <td>3676000</td>
      <td>5543000</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>8.30</td>
      <td>4825</td>
      <td>1885</td>
      <td>1835</td>
      <td>2520</td>
      <td>1565</td>
      <td>1240</td>
      <td>7</td>
      <td>2.70</td>
      <td>5.80</td>
      <td>suv</td>
      <td>4609500.00</td>
      <td>4</td>
    </tr>
    <tr>
      <th>29</th>
      <td>copen</td>
      <td>2382200</td>
      <td>2437200</td>
      <td>8</td>
      <td>1</td>
      <td>1</td>
      <td>18.60</td>
      <td>3395</td>
      <td>1475</td>
      <td>1280</td>
      <td>910</td>
      <td>1250</td>
      <td>1040</td>
      <td>2</td>
      <td>0.66</td>
      <td>4.60</td>
      <td>sport</td>
      <td>2409700.00</td>
      <td>7</td>
    </tr>
    <tr>
      <th>30</th>
      <td>grcorolla</td>
      <td>5250000</td>
      <td>5250000</td>
      <td>6</td>
      <td>3</td>
      <td>1</td>
      <td>12.40</td>
      <td>4410</td>
      <td>1850</td>
      <td>1480</td>
      <td>1790</td>
      <td>1510</td>
      <td>1155</td>
      <td>5</td>
      <td>1.60</td>
      <td>5.50</td>
      <td>sport</td>
      <td>5250000.00</td>
      <td>4</td>
    </tr>
    <tr>
      <th>31</th>
      <td>gr86</td>
      <td>2916000</td>
      <td>3574000</td>
      <td>7</td>
      <td>2</td>
      <td>1</td>
      <td>11.70</td>
      <td>4265</td>
      <td>1775</td>
      <td>1310</td>
      <td>1625</td>
      <td>1480</td>
      <td>1060</td>
      <td>4</td>
      <td>2.40</td>
      <td>5.40</td>
      <td>sport</td>
      <td>3245000.00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>32</th>
      <td>gryaris</td>
      <td>2650000</td>
      <td>4560000</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>13.60</td>
      <td>3995</td>
      <td>1805</td>
      <td>1455</td>
      <td>1880</td>
      <td>1430</td>
      <td>1175</td>
      <td>4</td>
      <td>1.50</td>
      <td>5.20</td>
      <td>sport</td>
      <td>3605000.00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>33</th>
      <td>supra</td>
      <td>4995000</td>
      <td>7313000</td>
      <td>5</td>
      <td>3</td>
      <td>1</td>
      <td>11.00</td>
      <td>4380</td>
      <td>1865</td>
      <td>1295</td>
      <td>970</td>
      <td>1460</td>
      <td>1060</td>
      <td>2</td>
      <td>2.00</td>
      <td>5.20</td>
      <td>sport</td>
      <td>6154000.00</td>
      <td>2</td>
    </tr>
    <tr>
      <th>34</th>
      <td>pixisepoch</td>
      <td>860200</td>
      <td>1364000</td>
      <td>7</td>
      <td>1</td>
      <td>1</td>
      <td>23.20</td>
      <td>3395</td>
      <td>1475</td>
      <td>1500</td>
      <td>2025</td>
      <td>1345</td>
      <td>1240</td>
      <td>4</td>
      <td>0.66</td>
      <td>4.40</td>
      <td>kei</td>
      <td>1112100.00</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-72d8a0bc-3224-478e-9f6b-79dd1336f706')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-72d8a0bc-3224-478e-9f6b-79dd1336f706 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-72d8a0bc-3224-478e-9f6b-79dd1336f706');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c9e157f1-f47b-4fea-8a3f-10a20a26505a">
  <button class="colab-df-quickchart" onclick="quickchart('df-c9e157f1-f47b-4fea-8a3f-10a20a26505a')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c9e157f1-f47b-4fea-8a3f-10a20a26505a button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_8e0192a7-9003-491f-ab37-e810f49ae377">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_8e0192a7-9003-491f-ab37-e810f49ae377 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_PCA</span><span class="p">[</span><span class="s2">&quot;car_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;carname&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train_PCA</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cls&#39;</span><span class="p">,</span> <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;car_name&#39;</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="566d4e42-2688-4078-8ea1-3c78652de506" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("566d4e42-2688-4078-8ea1-3c78652de506")) {                    Plotly.newPlot(                        "566d4e42-2688-4078-8ea1-3c78652de506",                        [{"customdata":[["aqua"],["corollasport"],["new-corolla"],["yaris"],["roomy"],["alphard"],["vellfire"],["voxy"],["granace"],["sienta"],["noah"],["hiacewagon"],["camry"],["corolla"],["corollaaxio"],["century"],["prius"],["mirai"],["corollatouring"],["corollafielder"],["corollacross"],["crown"],["harrier"],["yariscross"],["raize"],["rav4"],["landcruiser300"],["landcruiser70"],["landcruiserprado"],["copen"],["grcorolla"],["gr86"],["gryaris"],["supra"],["pixisepoch"]],"hovertemplate":"0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecar_name=%{customdata[0]}\u003cbr\u003ecls=%{marker.color}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":[7,7,7,3,3,2,5,0,2,7,0,0,0,7,3,1,0,5,7,3,7,5,4,7,3,4,2,4,4,7,4,0,0,2,6],"coloraxis":"coloraxis","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[-2048261.4734359554,-1800761.4428917568,-1851761.4316839993,-2248261.4809616394,-2512511.4897872284,2714238.635657805,3389238.6323345555,-820761.3860095432,2225238.679057304,-1816761.430057957,-1065761.384775919,-847361.2914655084,-257261.39374025317,-1851761.4316832914,-2451461.4359150156,15734238.572855318,-670761.4271380939,3589738.5885955775,-1786761.4329124691,-2301361.4365575053,-1524261.4319004882,3454238.5995653756,318238.58541113534,-1814261.4581285086,-2318261.47236128,-60261.423937117914,2204238.6320548253,454238.5957137314,263738.6159943738,-1936061.5711808035,904238.5479187822,-1100761.4635536126,-740761.4813636417,1808238.5133565129,-3233661.527073698],"xaxis":"x","y":[-340.28059845970404,-239.57056828928614,-164.25723492347208,-354.537190869635,-68.71519569522331,901.0852038540112,856.109902878035,822.1852711852814,1328.2865870359622,413.33353103623995,839.6619568357846,1895.951295039327,69.21054753786713,-164.25563802262505,-67.96444679740594,-723.5057901291617,-197.97522786576448,-334.1789108081566,-189.55862240979036,-73.90940773942656,-137.14363726005718,-162.59145720521002,-81.86722029866033,-237.37897399600936,-192.81325305945182,-92.76753656746197,709.2037177498963,-44.134583676383265,548.5340951212862,-1509.6341846378168,-410.56921348107164,-541.8889201911625,-420.679663114002,-1234.3007694186115,-399.08386335814356],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"0"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"1"}},"coloraxis":{"colorbar":{"title":{"text":"cls"}},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"legend":{"tracegroupgap":0},"margin":{"t":60}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('566d4e42-2688-4078-8ea1-3c78652de506');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div></div>
</div>
<section id="k-node">
<h1>K-node<a class="headerlink" href="#k-node" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>kmodes
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting kmodes
  Downloading kmodes-0.12.2-py2.py3-none-any.whl (20 kB)
Requirement already satisfied: numpy&gt;=1.10.4 in /usr/local/lib/python3.10/dist-packages (from kmodes) (1.23.5)
Requirement already satisfied: scikit-learn&gt;=0.22.0 in /usr/local/lib/python3.10/dist-packages (from kmodes) (1.2.2)
Requirement already satisfied: scipy&gt;=0.13.3 in /usr/local/lib/python3.10/dist-packages (from kmodes) (1.11.4)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.10/dist-packages (from kmodes) (1.3.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn&gt;=0.22.0-&gt;kmodes) (3.2.0)
Installing collected packages: kmodes
Successfully installed kmodes-0.12.2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-252d7aa0-90a8-42f7-84e4-9c6031e17a58" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carname</th>
      <th>min_cost</th>
      <th>max_cost</th>
      <th>body_color_cnt</th>
      <th>interior_color_cnt</th>
      <th>engine_type_cnt</th>
      <th>min_mileage</th>
      <th>body_l</th>
      <th>body_w</th>
      <th>body_h</th>
      <th>indoor_l</th>
      <th>indoor_w</th>
      <th>indoor_h</th>
      <th>passenger_num</th>
      <th>min_displacement</th>
      <th>min_mrr</th>
      <th>model</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>aqua</td>
      <td>1997000</td>
      <td>2598000</td>
      <td>13</td>
      <td>3</td>
      <td>1</td>
      <td>29.30</td>
      <td>4050</td>
      <td>1695</td>
      <td>1485</td>
      <td>1830</td>
      <td>1425</td>
      <td>1190</td>
      <td>5</td>
      <td>1.50</td>
      <td>4.90</td>
      <td>compact</td>
    </tr>
    <tr>
      <th>1</th>
      <td>corollasport</td>
      <td>2200000</td>
      <td>2890000</td>
      <td>9</td>
      <td>3</td>
      <td>2</td>
      <td>27.20</td>
      <td>4375</td>
      <td>1790</td>
      <td>1460</td>
      <td>1795</td>
      <td>1510</td>
      <td>1155</td>
      <td>5</td>
      <td>1.80</td>
      <td>5.10</td>
      <td>compact</td>
    </tr>
    <tr>
      <th>2</th>
      <td>new-corolla</td>
      <td>1990000</td>
      <td>2998000</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>25.30</td>
      <td>4495</td>
      <td>1745</td>
      <td>1435</td>
      <td>1830</td>
      <td>1510</td>
      <td>1160</td>
      <td>5</td>
      <td>1.50</td>
      <td>5.00</td>
      <td>compact</td>
    </tr>
    <tr>
      <th>3</th>
      <td>yaris</td>
      <td>1501000</td>
      <td>2694000</td>
      <td>11</td>
      <td>2</td>
      <td>2</td>
      <td>30.20</td>
      <td>3950</td>
      <td>1695</td>
      <td>1495</td>
      <td>1845</td>
      <td>1430</td>
      <td>1190</td>
      <td>5</td>
      <td>1.00</td>
      <td>4.80</td>
      <td>compact</td>
    </tr>
    <tr>
      <th>4</th>
      <td>roomy</td>
      <td>1566500</td>
      <td>2100000</td>
      <td>10</td>
      <td>1</td>
      <td>1</td>
      <td>16.80</td>
      <td>3705</td>
      <td>1670</td>
      <td>1735</td>
      <td>2180</td>
      <td>1480</td>
      <td>1355</td>
      <td>5</td>
      <td>1.00</td>
      <td>4.60</td>
      <td>compact</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-252d7aa0-90a8-42f7-84e4-9c6031e17a58')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-252d7aa0-90a8-42f7-84e4-9c6031e17a58 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-252d7aa0-90a8-42f7-84e4-9c6031e17a58');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-701f6c43-39df-4f30-adf8-fc520b0f3c69">
  <button class="colab-df-quickchart" onclick="quickchart('df-701f6c43-39df-4f30-adf8-fc520b0f3c69')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-701f6c43-39df-4f30-adf8-fc520b0f3c69 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>carname                 object
min_cost                 int64
max_cost                 int64
body_color_cnt           int64
interior_color_cnt       int64
engine_type_cnt          int64
min_mileage            float64
body_l                   int64
body_w                   int64
body_h                   int64
indoor_l                 int64
indoor_w                 int64
indoor_h                 int64
passenger_num            int64
min_displacement       float64
min_mrr                float64
model                 category
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-2f65dfe8-fa5c-4bb1-9372-7844fe85d8ef" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min_cost</th>
      <th>max_cost</th>
      <th>body_color_cnt</th>
      <th>interior_color_cnt</th>
      <th>engine_type_cnt</th>
      <th>min_mileage</th>
      <th>body_l</th>
      <th>body_w</th>
      <th>body_h</th>
      <th>indoor_l</th>
      <th>indoor_w</th>
      <th>indoor_h</th>
      <th>passenger_num</th>
      <th>min_displacement</th>
      <th>min_mrr</th>
      <th>model</th>
      <th>cls</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1997000</td>
      <td>2598000</td>
      <td>13</td>
      <td>3</td>
      <td>1</td>
      <td>29.30</td>
      <td>4050</td>
      <td>1695</td>
      <td>1485</td>
      <td>1830</td>
      <td>1425</td>
      <td>1190</td>
      <td>5</td>
      <td>1.50</td>
      <td>4.90</td>
      <td>compact</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2200000</td>
      <td>2890000</td>
      <td>9</td>
      <td>3</td>
      <td>2</td>
      <td>27.20</td>
      <td>4375</td>
      <td>1790</td>
      <td>1460</td>
      <td>1795</td>
      <td>1510</td>
      <td>1155</td>
      <td>5</td>
      <td>1.80</td>
      <td>5.10</td>
      <td>compact</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1990000</td>
      <td>2998000</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>25.30</td>
      <td>4495</td>
      <td>1745</td>
      <td>1435</td>
      <td>1830</td>
      <td>1510</td>
      <td>1160</td>
      <td>5</td>
      <td>1.50</td>
      <td>5.00</td>
      <td>compact</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1501000</td>
      <td>2694000</td>
      <td>11</td>
      <td>2</td>
      <td>2</td>
      <td>30.20</td>
      <td>3950</td>
      <td>1695</td>
      <td>1495</td>
      <td>1845</td>
      <td>1430</td>
      <td>1190</td>
      <td>5</td>
      <td>1.00</td>
      <td>4.80</td>
      <td>compact</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1566500</td>
      <td>2100000</td>
      <td>10</td>
      <td>1</td>
      <td>1</td>
      <td>16.80</td>
      <td>3705</td>
      <td>1670</td>
      <td>1735</td>
      <td>2180</td>
      <td>1480</td>
      <td>1355</td>
      <td>5</td>
      <td>1.00</td>
      <td>4.60</td>
      <td>compact</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2f65dfe8-fa5c-4bb1-9372-7844fe85d8ef')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2f65dfe8-fa5c-4bb1-9372-7844fe85d8ef button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2f65dfe8-fa5c-4bb1-9372-7844fe85d8ef');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-e48e4647-8ce8-464d-acd0-e245a476bc7f">
  <button class="colab-df-quickchart" onclick="quickchart('df-e48e4647-8ce8-464d-acd0-e245a476bc7f')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-e48e4647-8ce8-464d-acd0-e245a476bc7f button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_PCA</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span>
<span class="n">X_train_PCA</span> <span class="o">=</span> <span class="n">X_train_PCA</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">]]</span>
<span class="n">X_train_PCA</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-28bdc9a4-fa90-4fe7-bdb8-1860293488e8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>model</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-2048261.47</td>
      <td>-340.28</td>
      <td>compact</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1800761.44</td>
      <td>-239.57</td>
      <td>compact</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1851761.43</td>
      <td>-164.26</td>
      <td>compact</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-2248261.48</td>
      <td>-354.54</td>
      <td>compact</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-2512511.49</td>
      <td>-68.72</td>
      <td>compact</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2714238.64</td>
      <td>901.09</td>
      <td>mini-ban</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3389238.63</td>
      <td>856.11</td>
      <td>mini-ban</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-820761.39</td>
      <td>822.19</td>
      <td>mini-ban</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2225238.68</td>
      <td>1328.29</td>
      <td>mini-ban</td>
    </tr>
    <tr>
      <th>9</th>
      <td>-1816761.43</td>
      <td>413.33</td>
      <td>mini-ban</td>
    </tr>
    <tr>
      <th>10</th>
      <td>-1065761.38</td>
      <td>839.66</td>
      <td>mini-ban</td>
    </tr>
    <tr>
      <th>11</th>
      <td>-847361.29</td>
      <td>1895.95</td>
      <td>mini-ban</td>
    </tr>
    <tr>
      <th>12</th>
      <td>-257261.39</td>
      <td>69.21</td>
      <td>sedan</td>
    </tr>
    <tr>
      <th>13</th>
      <td>-1851761.43</td>
      <td>-164.26</td>
      <td>sedan</td>
    </tr>
    <tr>
      <th>14</th>
      <td>-2451461.44</td>
      <td>-67.96</td>
      <td>sedan</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15734238.57</td>
      <td>-723.51</td>
      <td>century</td>
    </tr>
    <tr>
      <th>16</th>
      <td>-670761.43</td>
      <td>-197.98</td>
      <td>sedan</td>
    </tr>
    <tr>
      <th>17</th>
      <td>3589738.59</td>
      <td>-334.18</td>
      <td>sedan</td>
    </tr>
    <tr>
      <th>18</th>
      <td>-1786761.43</td>
      <td>-189.56</td>
      <td>wagon</td>
    </tr>
    <tr>
      <th>19</th>
      <td>-2301361.44</td>
      <td>-73.91</td>
      <td>wagon</td>
    </tr>
    <tr>
      <th>20</th>
      <td>-1524261.43</td>
      <td>-137.14</td>
      <td>suv</td>
    </tr>
    <tr>
      <th>21</th>
      <td>3454238.60</td>
      <td>-162.59</td>
      <td>suv</td>
    </tr>
    <tr>
      <th>22</th>
      <td>318238.59</td>
      <td>-81.87</td>
      <td>suv</td>
    </tr>
    <tr>
      <th>23</th>
      <td>-1814261.46</td>
      <td>-237.38</td>
      <td>suv</td>
    </tr>
    <tr>
      <th>24</th>
      <td>-2318261.47</td>
      <td>-192.81</td>
      <td>suv</td>
    </tr>
    <tr>
      <th>25</th>
      <td>-60261.42</td>
      <td>-92.77</td>
      <td>suv</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2204238.63</td>
      <td>709.20</td>
      <td>suv</td>
    </tr>
    <tr>
      <th>27</th>
      <td>454238.60</td>
      <td>-44.13</td>
      <td>suv</td>
    </tr>
    <tr>
      <th>28</th>
      <td>263738.62</td>
      <td>548.53</td>
      <td>suv</td>
    </tr>
    <tr>
      <th>29</th>
      <td>-1936061.57</td>
      <td>-1509.63</td>
      <td>sport</td>
    </tr>
    <tr>
      <th>30</th>
      <td>904238.55</td>
      <td>-410.57</td>
      <td>sport</td>
    </tr>
    <tr>
      <th>31</th>
      <td>-1100761.46</td>
      <td>-541.89</td>
      <td>sport</td>
    </tr>
    <tr>
      <th>32</th>
      <td>-740761.48</td>
      <td>-420.68</td>
      <td>sport</td>
    </tr>
    <tr>
      <th>33</th>
      <td>1808238.51</td>
      <td>-1234.30</td>
      <td>sport</td>
    </tr>
    <tr>
      <th>34</th>
      <td>-3233661.53</td>
      <td>-399.08</td>
      <td>kei</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-28bdc9a4-fa90-4fe7-bdb8-1860293488e8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-28bdc9a4-fa90-4fe7-bdb8-1860293488e8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-28bdc9a4-fa90-4fe7-bdb8-1860293488e8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-6ccdf4f2-122a-44db-bddc-4b327c832d56">
  <button class="colab-df-quickchart" onclick="quickchart('df-6ccdf4f2-122a-44db-bddc-4b327c832d56')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-6ccdf4f2-122a-44db-bddc-4b327c832d56 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_14eb8e95-98e9-46f7-82d8-d39072059052">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('X_train_PCA')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_14eb8e95-98e9-46f7-82d8-d39072059052 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('X_train_PCA');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">kmodes.kprototypes</span> <span class="kn">import</span> <span class="n">KPrototypes</span>

<span class="c1"># t_df = df.iloc[:, 1:]</span>
<span class="n">t_df</span> <span class="o">=</span> <span class="n">X_train_PCA</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">syms</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;carname&#39;</span><span class="p">]</span>
<span class="n">kproto</span> <span class="o">=</span> <span class="n">KPrototypes</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="s1">&#39;Cao&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialization method and algorithm are deterministic. Setting n_init to 1.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clusters</span> <span class="o">=</span> <span class="n">kproto</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">t_df</span><span class="p">,</span> <span class="n">categorical</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># Print cluster centroids of the trained model.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">kproto</span><span class="o">.</span><span class="n">cluster_centroids_</span><span class="p">)</span>
<span class="c1"># Print training statistics</span>
<span class="nb">print</span><span class="p">(</span><span class="n">kproto</span><span class="o">.</span><span class="n">cost_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">kproto</span><span class="o">.</span><span class="n">n_iter_</span><span class="p">)</span>

<span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">syms</span><span class="p">,</span> <span class="n">clusters</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Symbol: </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">, cluster:</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Starting iterations...
Run: 1, iteration: 1/100, moves: 5, ncost: 7562783904561.083
Run: 1, iteration: 2/100, moves: 0, ncost: 7562783904561.083
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Starting iterations...
Run: 2, iteration: 1/100, moves: 2, ncost: 5611132792483.774
Run: 2, iteration: 2/100, moves: 0, ncost: 5611132792483.774
Init: initializing centroids
Init: initializing clusters
Starting iterations...
Run: 3, iteration: 1/100, moves: 0, ncost: 5728544009769.309
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Starting iterations...
Run: 4, iteration: 1/100, moves: 3, ncost: 5299573332719.269
Run: 4, iteration: 2/100, moves: 1, ncost: 5182446669173.119
Run: 4, iteration: 3/100, moves: 0, ncost: 5182446669173.119
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Starting iterations...
Run: 5, iteration: 1/100, moves: 2, ncost: 9844057410390.664
Run: 5, iteration: 2/100, moves: 2, ncost: 8520680982897.891
Run: 5, iteration: 3/100, moves: 4, ncost: 6550048315734.802
Run: 5, iteration: 4/100, moves: 1, ncost: 6440330746941.2
Run: 5, iteration: 5/100, moves: 0, ncost: 6440330746941.2
Init: initializing centroids
Init: initializing clusters
Starting iterations...
Run: 6, iteration: 1/100, moves: 9, ncost: 45906530102718.45
Run: 6, iteration: 2/100, moves: 2, ncost: 7592438001060.607
Run: 6, iteration: 3/100, moves: 1, ncost: 7562783904561.084
Run: 6, iteration: 4/100, moves: 0, ncost: 7562783904561.084
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Starting iterations...
Run: 7, iteration: 1/100, moves: 9, ncost: 5513784270353.52
Run: 7, iteration: 2/100, moves: 1, ncost: 5416903854225.783
Run: 7, iteration: 3/100, moves: 0, ncost: 5416903854225.783
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Starting iterations...
Run: 8, iteration: 1/100, moves: 6, ncost: 5651442517648.213
Run: 8, iteration: 2/100, moves: 1, ncost: 5611132792483.774
Run: 8, iteration: 3/100, moves: 0, ncost: 5611132792483.774
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Starting iterations...
Run: 9, iteration: 1/100, moves: 9, ncost: 6159744970751.551
Run: 9, iteration: 2/100, moves: 1, ncost: 6066638693149.116
Run: 9, iteration: 3/100, moves: 0, ncost: 6066638693149.116
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Init: initializing centroids
Init: initializing clusters
Starting iterations...
Run: 10, iteration: 1/100, moves: 6, ncost: 5415503594909.13
Run: 10, iteration: 2/100, moves: 0, ncost: 5415503594909.13
Best run was number 4
[[&#39;376038.584220181&#39; &#39;-16.160891780458194&#39; &#39;suv&#39;]
 [&#39;-3233661.527073698&#39; &#39;-399.08386335814356&#39; &#39;kei&#39;]
 [&#39;2769310.040088851&#39; &#39;294.80203915513226&#39; &#39;mini-ban&#39;]
 [&#39;-786204.2611495102&#39; &#39;352.35217991819025&#39; &#39;mini-ban&#39;]
 [&#39;-2018750.7442469927&#39; &#39;-237.62038722311885&#39; &#39;compact&#39;]
 [&#39;15734238.57285532&#39; &#39;-723.5057901291616&#39; &#39;century&#39;]]
5182446669173.119
3
Symbol: aqua, cluster:4
Symbol: corollasport, cluster:4
Symbol: new-corolla, cluster:4
Symbol: yaris, cluster:4
Symbol: roomy, cluster:4
Symbol: alphard, cluster:2
Symbol: vellfire, cluster:2
Symbol: voxy, cluster:3
Symbol: granace, cluster:2
Symbol: sienta, cluster:4
Symbol: noah, cluster:3
Symbol: hiacewagon, cluster:3
Symbol: camry, cluster:3
Symbol: corolla, cluster:4
Symbol: corollaaxio, cluster:4
Symbol: century, cluster:5
Symbol: prius, cluster:3
Symbol: mirai, cluster:2
Symbol: corollatouring, cluster:4
Symbol: corollafielder, cluster:4
Symbol: corollacross, cluster:4
Symbol: crown, cluster:2
Symbol: harrier, cluster:0
Symbol: yariscross, cluster:4
Symbol: raize, cluster:4
Symbol: rav4, cluster:0
Symbol: landcruiser300, cluster:2
Symbol: landcruiser70, cluster:0
Symbol: landcruiserprado, cluster:0
Symbol: copen, cluster:4
Symbol: grcorolla, cluster:0
Symbol: gr86, cluster:3
Symbol: gryaris, cluster:3
Symbol: supra, cluster:2
Symbol: pixisepoch, cluster:1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;cls&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clusters</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-7c52c5b5-e27d-43ab-baa1-4a7584e9b58c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carname</th>
      <th>min_cost</th>
      <th>max_cost</th>
      <th>body_color_cnt</th>
      <th>interior_color_cnt</th>
      <th>engine_type_cnt</th>
      <th>min_mileage</th>
      <th>body_l</th>
      <th>body_w</th>
      <th>body_h</th>
      <th>indoor_l</th>
      <th>indoor_w</th>
      <th>indoor_h</th>
      <th>passenger_num</th>
      <th>min_displacement</th>
      <th>min_mrr</th>
      <th>model</th>
      <th>cls</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>aqua</td>
      <td>1997000</td>
      <td>2598000</td>
      <td>13</td>
      <td>3</td>
      <td>1</td>
      <td>29.30</td>
      <td>4050</td>
      <td>1695</td>
      <td>1485</td>
      <td>1830</td>
      <td>1425</td>
      <td>1190</td>
      <td>5</td>
      <td>1.50</td>
      <td>4.90</td>
      <td>compact</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>corollasport</td>
      <td>2200000</td>
      <td>2890000</td>
      <td>9</td>
      <td>3</td>
      <td>2</td>
      <td>27.20</td>
      <td>4375</td>
      <td>1790</td>
      <td>1460</td>
      <td>1795</td>
      <td>1510</td>
      <td>1155</td>
      <td>5</td>
      <td>1.80</td>
      <td>5.10</td>
      <td>compact</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>new-corolla</td>
      <td>1990000</td>
      <td>2998000</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>25.30</td>
      <td>4495</td>
      <td>1745</td>
      <td>1435</td>
      <td>1830</td>
      <td>1510</td>
      <td>1160</td>
      <td>5</td>
      <td>1.50</td>
      <td>5.00</td>
      <td>compact</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>yaris</td>
      <td>1501000</td>
      <td>2694000</td>
      <td>11</td>
      <td>2</td>
      <td>2</td>
      <td>30.20</td>
      <td>3950</td>
      <td>1695</td>
      <td>1495</td>
      <td>1845</td>
      <td>1430</td>
      <td>1190</td>
      <td>5</td>
      <td>1.00</td>
      <td>4.80</td>
      <td>compact</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>roomy</td>
      <td>1566500</td>
      <td>2100000</td>
      <td>10</td>
      <td>1</td>
      <td>1</td>
      <td>16.80</td>
      <td>3705</td>
      <td>1670</td>
      <td>1735</td>
      <td>2180</td>
      <td>1480</td>
      <td>1355</td>
      <td>5</td>
      <td>1.00</td>
      <td>4.60</td>
      <td>compact</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alphard</td>
      <td>5400000</td>
      <td>8720000</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>16.50</td>
      <td>4995</td>
      <td>1850</td>
      <td>1935</td>
      <td>3005</td>
      <td>1660</td>
      <td>1360</td>
      <td>7</td>
      <td>2.50</td>
      <td>5.90</td>
      <td>mini-ban</td>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>vellfire</td>
      <td>6550000</td>
      <td>8920000</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>16.50</td>
      <td>4995</td>
      <td>1850</td>
      <td>1945</td>
      <td>3005</td>
      <td>1660</td>
      <td>1360</td>
      <td>7</td>
      <td>2.40</td>
      <td>5.90</td>
      <td>mini-ban</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>voxy</td>
      <td>3090000</td>
      <td>3960000</td>
      <td>6</td>
      <td>1</td>
      <td>2</td>
      <td>22.00</td>
      <td>4695</td>
      <td>1730</td>
      <td>1895</td>
      <td>2805</td>
      <td>1470</td>
      <td>1405</td>
      <td>7</td>
      <td>1.80</td>
      <td>5.50</td>
      <td>mini-ban</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>granace</td>
      <td>6421000</td>
      <td>6721000</td>
      <td>4</td>
      <td>4</td>
      <td>1</td>
      <td>10.00</td>
      <td>5300</td>
      <td>1970</td>
      <td>1990</td>
      <td>3290</td>
      <td>1735</td>
      <td>1290</td>
      <td>6</td>
      <td>2.80</td>
      <td>5.60</td>
      <td>mini-ban</td>
      <td>2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>sienta</td>
      <td>1950000</td>
      <td>3108000</td>
      <td>9</td>
      <td>3</td>
      <td>2</td>
      <td>25.30</td>
      <td>4260</td>
      <td>1695</td>
      <td>1695</td>
      <td>2545</td>
      <td>1530</td>
      <td>1300</td>
      <td>5</td>
      <td>1.50</td>
      <td>5.00</td>
      <td>mini-ban</td>
      <td>4</td>
    </tr>
    <tr>
      <th>10</th>
      <td>noah</td>
      <td>2670000</td>
      <td>3890000</td>
      <td>6</td>
      <td>1</td>
      <td>2</td>
      <td>22.00</td>
      <td>4695</td>
      <td>1730</td>
      <td>1895</td>
      <td>2805</td>
      <td>1470</td>
      <td>1405</td>
      <td>7</td>
      <td>1.80</td>
      <td>5.50</td>
      <td>mini-ban</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11</th>
      <td>hiacewagon</td>
      <td>2946600</td>
      <td>4050200</td>
      <td>7</td>
      <td>1</td>
      <td>1</td>
      <td>8.10</td>
      <td>5380</td>
      <td>1880</td>
      <td>2285</td>
      <td>3525</td>
      <td>1695</td>
      <td>1565</td>
      <td>10</td>
      <td>2.70</td>
      <td>5.20</td>
      <td>mini-ban</td>
      <td>1</td>
    </tr>
    <tr>
      <th>12</th>
      <td>camry</td>
      <td>3495000</td>
      <td>4682000</td>
      <td>7</td>
      <td>1</td>
      <td>1</td>
      <td>21.60</td>
      <td>4910</td>
      <td>1840</td>
      <td>1445</td>
      <td>2010</td>
      <td>1535</td>
      <td>1185</td>
      <td>5</td>
      <td>2.50</td>
      <td>1.50</td>
      <td>sedan</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>corolla</td>
      <td>1990000</td>
      <td>2998000</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>25.30</td>
      <td>4495</td>
      <td>1745</td>
      <td>1435</td>
      <td>1830</td>
      <td>1510</td>
      <td>1160</td>
      <td>5</td>
      <td>5.70</td>
      <td>5.00</td>
      <td>sedan</td>
      <td>4</td>
    </tr>
    <tr>
      <th>14</th>
      <td>corollaaxio</td>
      <td>1611600</td>
      <td>2177000</td>
      <td>4</td>
      <td>1</td>
      <td>2</td>
      <td>27.80</td>
      <td>4400</td>
      <td>1695</td>
      <td>1460</td>
      <td>1945</td>
      <td>1430</td>
      <td>1200</td>
      <td>5</td>
      <td>1.50</td>
      <td>4.90</td>
      <td>sedan</td>
      <td>4</td>
    </tr>
    <tr>
      <th>15</th>
      <td>century</td>
      <td>20080000</td>
      <td>20080000</td>
      <td>4</td>
      <td>7</td>
      <td>1</td>
      <td>12.40</td>
      <td>5335</td>
      <td>1930</td>
      <td>1505</td>
      <td>2165</td>
      <td>1605</td>
      <td>1185</td>
      <td>5</td>
      <td>5.00</td>
      <td>5.90</td>
      <td>century</td>
      <td>5</td>
    </tr>
    <tr>
      <th>16</th>
      <td>prius</td>
      <td>2750000</td>
      <td>4600000</td>
      <td>6</td>
      <td>2</td>
      <td>2</td>
      <td>26.70</td>
      <td>4600</td>
      <td>1780</td>
      <td>1430</td>
      <td>1840</td>
      <td>1500</td>
      <td>1130</td>
      <td>5</td>
      <td>1.80</td>
      <td>5.30</td>
      <td>sedan</td>
      <td>1</td>
    </tr>
    <tr>
      <th>17</th>
      <td>mirai</td>
      <td>7261000</td>
      <td>8610000</td>
      <td>8</td>
      <td>2</td>
      <td>1</td>
      <td>146.00</td>
      <td>4975</td>
      <td>1885</td>
      <td>1470</td>
      <td>1805</td>
      <td>1595</td>
      <td>1135</td>
      <td>5</td>
      <td>0.00</td>
      <td>5.80</td>
      <td>sedan</td>
      <td>2</td>
    </tr>
    <tr>
      <th>18</th>
      <td>corollatouring</td>
      <td>2070000</td>
      <td>3048000</td>
      <td>7</td>
      <td>2</td>
      <td>2</td>
      <td>24.90</td>
      <td>4495</td>
      <td>1745</td>
      <td>1460</td>
      <td>1795</td>
      <td>1510</td>
      <td>1160</td>
      <td>5</td>
      <td>1.50</td>
      <td>5.00</td>
      <td>wagon</td>
      <td>4</td>
    </tr>
    <tr>
      <th>19</th>
      <td>corollafielder</td>
      <td>1758400</td>
      <td>2330400</td>
      <td>4</td>
      <td>1</td>
      <td>2</td>
      <td>27.80</td>
      <td>4400</td>
      <td>1695</td>
      <td>1475</td>
      <td>1945</td>
      <td>1430</td>
      <td>1200</td>
      <td>5</td>
      <td>1.50</td>
      <td>4.90</td>
      <td>wagon</td>
      <td>4</td>
    </tr>
    <tr>
      <th>20</th>
      <td>corollacross</td>
      <td>2184000</td>
      <td>3459000</td>
      <td>11</td>
      <td>2</td>
      <td>2</td>
      <td>24.50</td>
      <td>4490</td>
      <td>1825</td>
      <td>1620</td>
      <td>1800</td>
      <td>1505</td>
      <td>1260</td>
      <td>5</td>
      <td>1.80</td>
      <td>5.20</td>
      <td>suv</td>
      <td>4</td>
    </tr>
    <tr>
      <th>21</th>
      <td>crown</td>
      <td>7300000</td>
      <td>8300000</td>
      <td>6</td>
      <td>2</td>
      <td>2</td>
      <td>18.00</td>
      <td>5030</td>
      <td>1890</td>
      <td>1475</td>
      <td>1970</td>
      <td>1595</td>
      <td>1135</td>
      <td>5</td>
      <td>2.50</td>
      <td>5.70</td>
      <td>suv</td>
      <td>2</td>
    </tr>
    <tr>
      <th>22</th>
      <td>harrier</td>
      <td>3128000</td>
      <td>6200000</td>
      <td>7</td>
      <td>2</td>
      <td>3</td>
      <td>21.60</td>
      <td>4740</td>
      <td>1855</td>
      <td>1660</td>
      <td>1880</td>
      <td>1520</td>
      <td>1215</td>
      <td>5</td>
      <td>2.00</td>
      <td>5.50</td>
      <td>suv</td>
      <td>0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>yariscross</td>
      <td>1907000</td>
      <td>3156000</td>
      <td>11</td>
      <td>1</td>
      <td>2</td>
      <td>25.00</td>
      <td>4200</td>
      <td>1765</td>
      <td>1590</td>
      <td>1845</td>
      <td>1430</td>
      <td>1205</td>
      <td>5</td>
      <td>1.50</td>
      <td>5.30</td>
      <td>suv</td>
      <td>4</td>
    </tr>
    <tr>
      <th>24</th>
      <td>raize</td>
      <td>1717000</td>
      <td>2338000</td>
      <td>11</td>
      <td>1</td>
      <td>2</td>
      <td>28.00</td>
      <td>3995</td>
      <td>1695</td>
      <td>1620</td>
      <td>1955</td>
      <td>1420</td>
      <td>1250</td>
      <td>5</td>
      <td>1.00</td>
      <td>4.90</td>
      <td>suv</td>
      <td>4</td>
    </tr>
    <tr>
      <th>25</th>
      <td>rav4</td>
      <td>2938000</td>
      <td>5633000</td>
      <td>6</td>
      <td>2</td>
      <td>3</td>
      <td>20.30</td>
      <td>4610</td>
      <td>1865</td>
      <td>1690</td>
      <td>1890</td>
      <td>1515</td>
      <td>1230</td>
      <td>5</td>
      <td>2.00</td>
      <td>5.50</td>
      <td>suv</td>
      <td>0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>landcruiser300</td>
      <td>5100000</td>
      <td>8000000</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>8.00</td>
      <td>4985</td>
      <td>1980</td>
      <td>1925</td>
      <td>2755</td>
      <td>1640</td>
      <td>1190</td>
      <td>7</td>
      <td>3.30</td>
      <td>5.90</td>
      <td>suv</td>
      <td>3</td>
    </tr>
    <tr>
      <th>27</th>
      <td>landcruiser70</td>
      <td>4800000</td>
      <td>4800000</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>10.10</td>
      <td>4890</td>
      <td>1870</td>
      <td>1920</td>
      <td>1760</td>
      <td>1440</td>
      <td>1240</td>
      <td>5</td>
      <td>2.80</td>
      <td>6.30</td>
      <td>suv</td>
      <td>0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>landcruiserprado</td>
      <td>3676000</td>
      <td>5543000</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>8.30</td>
      <td>4825</td>
      <td>1885</td>
      <td>1835</td>
      <td>2520</td>
      <td>1565</td>
      <td>1240</td>
      <td>7</td>
      <td>2.70</td>
      <td>5.80</td>
      <td>suv</td>
      <td>0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>copen</td>
      <td>2382200</td>
      <td>2437200</td>
      <td>8</td>
      <td>1</td>
      <td>1</td>
      <td>18.60</td>
      <td>3395</td>
      <td>1475</td>
      <td>1280</td>
      <td>910</td>
      <td>1250</td>
      <td>1040</td>
      <td>2</td>
      <td>0.66</td>
      <td>4.60</td>
      <td>sport</td>
      <td>4</td>
    </tr>
    <tr>
      <th>30</th>
      <td>grcorolla</td>
      <td>5250000</td>
      <td>5250000</td>
      <td>6</td>
      <td>3</td>
      <td>1</td>
      <td>12.40</td>
      <td>4410</td>
      <td>1850</td>
      <td>1480</td>
      <td>1790</td>
      <td>1510</td>
      <td>1155</td>
      <td>5</td>
      <td>1.60</td>
      <td>5.50</td>
      <td>sport</td>
      <td>0</td>
    </tr>
    <tr>
      <th>31</th>
      <td>gr86</td>
      <td>2916000</td>
      <td>3574000</td>
      <td>7</td>
      <td>2</td>
      <td>1</td>
      <td>11.70</td>
      <td>4265</td>
      <td>1775</td>
      <td>1310</td>
      <td>1625</td>
      <td>1480</td>
      <td>1060</td>
      <td>4</td>
      <td>2.40</td>
      <td>5.40</td>
      <td>sport</td>
      <td>1</td>
    </tr>
    <tr>
      <th>32</th>
      <td>gryaris</td>
      <td>2650000</td>
      <td>4560000</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>13.60</td>
      <td>3995</td>
      <td>1805</td>
      <td>1455</td>
      <td>1880</td>
      <td>1430</td>
      <td>1175</td>
      <td>4</td>
      <td>1.50</td>
      <td>5.20</td>
      <td>sport</td>
      <td>1</td>
    </tr>
    <tr>
      <th>33</th>
      <td>supra</td>
      <td>4995000</td>
      <td>7313000</td>
      <td>5</td>
      <td>3</td>
      <td>1</td>
      <td>11.00</td>
      <td>4380</td>
      <td>1865</td>
      <td>1295</td>
      <td>970</td>
      <td>1460</td>
      <td>1060</td>
      <td>2</td>
      <td>2.00</td>
      <td>5.20</td>
      <td>sport</td>
      <td>3</td>
    </tr>
    <tr>
      <th>34</th>
      <td>pixisepoch</td>
      <td>860200</td>
      <td>1364000</td>
      <td>7</td>
      <td>1</td>
      <td>1</td>
      <td>23.20</td>
      <td>3395</td>
      <td>1475</td>
      <td>1500</td>
      <td>2025</td>
      <td>1345</td>
      <td>1240</td>
      <td>4</td>
      <td>0.66</td>
      <td>4.40</td>
      <td>kei</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7c52c5b5-e27d-43ab-baa1-4a7584e9b58c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7c52c5b5-e27d-43ab-baa1-4a7584e9b58c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7c52c5b5-e27d-43ab-baa1-4a7584e9b58c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-7b185de9-0e00-4bc5-9262-36deb9d546ba">
  <button class="colab-df-quickchart" onclick="quickchart('df-7b185de9-0e00-4bc5-9262-36deb9d546ba')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-7b185de9-0e00-4bc5-9262-36deb9d546ba button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_cc1467f4-0061-4513-a0d9-f002ed2bd198">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_cc1467f4-0061-4513-a0d9-f002ed2bd198 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_PCA</span><span class="p">[</span><span class="s2">&quot;cls&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clusters</span>
<span class="n">X_train_PCA</span><span class="p">[</span><span class="s2">&quot;carname&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;carname&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-183-5fa1bf7ff9e0&gt;:1: SettingWithCopyWarning:


A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train_PCA</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cls&#39;</span><span class="p">,</span> <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;car_name&#39;</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="39cc3ea6-f55f-49fa-84ff-b35a3c92502a" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("39cc3ea6-f55f-49fa-84ff-b35a3c92502a")) {                    Plotly.newPlot(                        "39cc3ea6-f55f-49fa-84ff-b35a3c92502a",                        [{"customdata":[["aqua"],["corollasport"],["new-corolla"],["yaris"],["roomy"],["sienta"],["corolla"],["corollaaxio"],["corollatouring"],["corollafielder"],["corollacross"],["yariscross"],["raize"],["copen"],["pixisepoch"]],"hovertemplate":"cls=4\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecar_name=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"4","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"4","orientation":"v","showlegend":true,"x":[-2048261.4734359554,-1800761.4428917568,-1851761.4316839993,-2248261.4809616394,-2512511.4897872284,-1816761.430057957,-1851761.4316832914,-2451461.4359150156,-1786761.4329124691,-2301361.4365575053,-1524261.4319004882,-1814261.4581285086,-2318261.47236128,-1936061.5711808035,-3233661.527073698],"xaxis":"x","y":[-340.28059845970404,-239.57056828928614,-164.25723492347208,-354.537190869635,-68.71519569522331,413.33353103623995,-164.25563802262505,-67.96444679740594,-189.55862240979036,-73.90940773942656,-137.14363726005718,-237.37897399600936,-192.81325305945182,-1509.6341846378168,-399.08386335814356],"yaxis":"y","type":"scatter"},{"customdata":[["alphard"],["landcruiser300"],["supra"]],"hovertemplate":"cls=3\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecar_name=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"3","marker":{"color":"#EF553B","symbol":"circle"},"mode":"markers","name":"3","orientation":"v","showlegend":true,"x":[2714238.635657805,2204238.6320548253,1808238.5133565129],"xaxis":"x","y":[901.0852038540112,709.2037177498963,-1234.3007694186115],"yaxis":"y","type":"scatter"},{"customdata":[["vellfire"],["granace"],["mirai"],["crown"]],"hovertemplate":"cls=2\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecar_name=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"2","marker":{"color":"#00cc96","symbol":"circle"},"mode":"markers","name":"2","orientation":"v","showlegend":true,"x":[3389238.6323345555,2225238.679057304,3589738.5885955775,3454238.5995653756],"xaxis":"x","y":[856.109902878035,1328.2865870359622,-334.1789108081566,-162.59145720521002],"yaxis":"y","type":"scatter"},{"customdata":[["voxy"],["noah"],["hiacewagon"],["prius"],["gr86"],["gryaris"]],"hovertemplate":"cls=1\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecar_name=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"1","marker":{"color":"#ab63fa","symbol":"circle"},"mode":"markers","name":"1","orientation":"v","showlegend":true,"x":[-820761.3860095432,-1065761.384775919,-847361.2914655084,-670761.4271380939,-1100761.4635536126,-740761.4813636417],"xaxis":"x","y":[822.1852711852814,839.6619568357846,1895.951295039327,-197.97522786576448,-541.8889201911625,-420.679663114002],"yaxis":"y","type":"scatter"},{"customdata":[["camry"],["harrier"],["rav4"],["landcruiser70"],["landcruiserprado"],["grcorolla"]],"hovertemplate":"cls=0\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecar_name=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"0","marker":{"color":"#FFA15A","symbol":"circle"},"mode":"markers","name":"0","orientation":"v","showlegend":true,"x":[-257261.39374025317,318238.58541113534,-60261.423937117914,454238.5957137314,263738.6159943738,904238.5479187822],"xaxis":"x","y":[69.21054753786713,-81.86722029866033,-92.76753656746197,-44.134583676383265,548.5340951212862,-410.56921348107164],"yaxis":"y","type":"scatter"},{"customdata":[["century"]],"hovertemplate":"cls=5\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecar_name=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"5","marker":{"color":"#19d3f3","symbol":"circle"},"mode":"markers","name":"5","orientation":"v","showlegend":true,"x":[15734238.572855318],"xaxis":"x","y":[-723.5057901291617],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"0"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"1"}},"legend":{"title":{"text":"cls"},"tracegroupgap":0},"margin":{"t":60}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('39cc3ea6-f55f-49fa-84ff-b35a3c92502a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train_PCA</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cls&#39;</span><span class="p">,</span> <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;carname&#39;</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="74d7a228-b612-4aa4-88e9-bb1dabbec178" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("74d7a228-b612-4aa4-88e9-bb1dabbec178")) {                    Plotly.newPlot(                        "74d7a228-b612-4aa4-88e9-bb1dabbec178",                        [{"customdata":[["aqua","compact"],["corollasport","compact"],["new-corolla","compact"],["yaris","compact"],["roomy","compact"],["sienta","mini-ban"],["corolla","sedan"],["corollaaxio","sedan"],["corollatouring","wagon"],["corollafielder","wagon"],["corollacross","suv"],["yariscross","suv"],["raize","suv"],["copen","sport"]],"hovertemplate":"cls=4\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecarname=%{customdata[0]}\u003cbr\u003emodel=%{customdata[1]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"4","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"4","orientation":"v","showlegend":true,"x":[-2048261.4734359554,-1800761.4428917568,-1851761.4316839993,-2248261.4809616394,-2512511.4897872284,-1816761.430057957,-1851761.4316832914,-2451461.4359150156,-1786761.4329124691,-2301361.4365575053,-1524261.4319004882,-1814261.4581285086,-2318261.47236128,-1936061.5711808035],"xaxis":"x","y":[-340.28059845970404,-239.57056828928614,-164.25723492347208,-354.537190869635,-68.71519569522331,413.33353103623995,-164.25563802262505,-67.96444679740594,-189.55862240979036,-73.90940773942656,-137.14363726005718,-237.37897399600936,-192.81325305945182,-1509.6341846378168],"yaxis":"y","type":"scatter"},{"customdata":[["alphard","mini-ban"],["vellfire","mini-ban"],["granace","mini-ban"],["mirai","sedan"],["crown","suv"],["landcruiser300","suv"],["supra","sport"]],"hovertemplate":"cls=2\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecarname=%{customdata[0]}\u003cbr\u003emodel=%{customdata[1]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"2","marker":{"color":"#EF553B","symbol":"circle"},"mode":"markers","name":"2","orientation":"v","showlegend":true,"x":[2714238.635657805,3389238.6323345555,2225238.679057304,3589738.5885955775,3454238.5995653756,2204238.6320548253,1808238.5133565129],"xaxis":"x","y":[901.0852038540112,856.109902878035,1328.2865870359622,-334.1789108081566,-162.59145720521002,709.2037177498963,-1234.3007694186115],"yaxis":"y","type":"scatter"},{"customdata":[["voxy","mini-ban"],["noah","mini-ban"],["hiacewagon","mini-ban"],["camry","sedan"],["prius","sedan"],["gr86","sport"],["gryaris","sport"]],"hovertemplate":"cls=3\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecarname=%{customdata[0]}\u003cbr\u003emodel=%{customdata[1]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"3","marker":{"color":"#00cc96","symbol":"circle"},"mode":"markers","name":"3","orientation":"v","showlegend":true,"x":[-820761.3860095432,-1065761.384775919,-847361.2914655084,-257261.39374025317,-670761.4271380939,-1100761.4635536126,-740761.4813636417],"xaxis":"x","y":[822.1852711852814,839.6619568357846,1895.951295039327,69.21054753786713,-197.97522786576448,-541.8889201911625,-420.679663114002],"yaxis":"y","type":"scatter"},{"customdata":[["century","century"]],"hovertemplate":"cls=5\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecarname=%{customdata[0]}\u003cbr\u003emodel=%{customdata[1]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"5","marker":{"color":"#ab63fa","symbol":"circle"},"mode":"markers","name":"5","orientation":"v","showlegend":true,"x":[15734238.572855318],"xaxis":"x","y":[-723.5057901291617],"yaxis":"y","type":"scatter"},{"customdata":[["harrier","suv"],["rav4","suv"],["landcruiser70","suv"],["landcruiserprado","suv"],["grcorolla","sport"]],"hovertemplate":"cls=0\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecarname=%{customdata[0]}\u003cbr\u003emodel=%{customdata[1]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"0","marker":{"color":"#FFA15A","symbol":"circle"},"mode":"markers","name":"0","orientation":"v","showlegend":true,"x":[318238.58541113534,-60261.423937117914,454238.5957137314,263738.6159943738,904238.5479187822],"xaxis":"x","y":[-81.86722029866033,-92.76753656746197,-44.134583676383265,548.5340951212862,-410.56921348107164],"yaxis":"y","type":"scatter"},{"customdata":[["pixisepoch","kei"]],"hovertemplate":"cls=1\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecarname=%{customdata[0]}\u003cbr\u003emodel=%{customdata[1]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"1","marker":{"color":"#19d3f3","symbol":"circle"},"mode":"markers","name":"1","orientation":"v","showlegend":true,"x":[-3233661.527073698],"xaxis":"x","y":[-399.08386335814356],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"0"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"1"}},"legend":{"title":{"text":"cls"},"tracegroupgap":0},"margin":{"t":60}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('74d7a228-b612-4aa4-88e9-bb1dabbec178');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train_PCA</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;carname&#39;</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="4bff50c4-92a2-4832-b152-50acd13e05e6" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("4bff50c4-92a2-4832-b152-50acd13e05e6")) {                    Plotly.newPlot(                        "4bff50c4-92a2-4832-b152-50acd13e05e6",                        [{"customdata":[["aqua","compact"],["corollasport","compact"],["new-corolla","compact"],["yaris","compact"],["roomy","compact"]],"hovertemplate":"model=%{customdata[1]}\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecarname=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"compact","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"compact","orientation":"v","showlegend":true,"x":[-2048261.4734359554,-1800761.4428917568,-1851761.4316839993,-2248261.4809616394,-2512511.4897872284],"xaxis":"x","y":[-340.28059845970404,-239.57056828928614,-164.25723492347208,-354.537190869635,-68.71519569522331],"yaxis":"y","type":"scatter"},{"customdata":[["alphard","mini-ban"],["vellfire","mini-ban"],["voxy","mini-ban"],["granace","mini-ban"],["sienta","mini-ban"],["noah","mini-ban"],["hiacewagon","mini-ban"]],"hovertemplate":"model=%{customdata[1]}\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecarname=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"mini-ban","marker":{"color":"#EF553B","symbol":"circle"},"mode":"markers","name":"mini-ban","orientation":"v","showlegend":true,"x":[2714238.635657805,3389238.6323345555,-820761.3860095432,2225238.679057304,-1816761.430057957,-1065761.384775919,-847361.2914655084],"xaxis":"x","y":[901.0852038540112,856.109902878035,822.1852711852814,1328.2865870359622,413.33353103623995,839.6619568357846,1895.951295039327],"yaxis":"y","type":"scatter"},{"customdata":[["camry","sedan"],["corolla","sedan"],["corollaaxio","sedan"],["prius","sedan"],["mirai","sedan"]],"hovertemplate":"model=%{customdata[1]}\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecarname=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"sedan","marker":{"color":"#00cc96","symbol":"circle"},"mode":"markers","name":"sedan","orientation":"v","showlegend":true,"x":[-257261.39374025317,-1851761.4316832914,-2451461.4359150156,-670761.4271380939,3589738.5885955775],"xaxis":"x","y":[69.21054753786713,-164.25563802262505,-67.96444679740594,-197.97522786576448,-334.1789108081566],"yaxis":"y","type":"scatter"},{"customdata":[["century","century"]],"hovertemplate":"model=%{customdata[1]}\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecarname=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"century","marker":{"color":"#ab63fa","symbol":"circle"},"mode":"markers","name":"century","orientation":"v","showlegend":true,"x":[15734238.572855318],"xaxis":"x","y":[-723.5057901291617],"yaxis":"y","type":"scatter"},{"customdata":[["corollatouring","wagon"],["corollafielder","wagon"]],"hovertemplate":"model=%{customdata[1]}\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecarname=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"wagon","marker":{"color":"#FFA15A","symbol":"circle"},"mode":"markers","name":"wagon","orientation":"v","showlegend":true,"x":[-1786761.4329124691,-2301361.4365575053],"xaxis":"x","y":[-189.55862240979036,-73.90940773942656],"yaxis":"y","type":"scatter"},{"customdata":[["corollacross","suv"],["crown","suv"],["harrier","suv"],["yariscross","suv"],["raize","suv"],["rav4","suv"],["landcruiser300","suv"],["landcruiser70","suv"],["landcruiserprado","suv"]],"hovertemplate":"model=%{customdata[1]}\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecarname=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"suv","marker":{"color":"#19d3f3","symbol":"circle"},"mode":"markers","name":"suv","orientation":"v","showlegend":true,"x":[-1524261.4319004882,3454238.5995653756,318238.58541113534,-1814261.4581285086,-2318261.47236128,-60261.423937117914,2204238.6320548253,454238.5957137314,263738.6159943738],"xaxis":"x","y":[-137.14363726005718,-162.59145720521002,-81.86722029866033,-237.37897399600936,-192.81325305945182,-92.76753656746197,709.2037177498963,-44.134583676383265,548.5340951212862],"yaxis":"y","type":"scatter"},{"customdata":[["copen","sport"],["grcorolla","sport"],["gr86","sport"],["gryaris","sport"],["supra","sport"]],"hovertemplate":"model=%{customdata[1]}\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecarname=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"sport","marker":{"color":"#FF6692","symbol":"circle"},"mode":"markers","name":"sport","orientation":"v","showlegend":true,"x":[-1936061.5711808035,904238.5479187822,-1100761.4635536126,-740761.4813636417,1808238.5133565129],"xaxis":"x","y":[-1509.6341846378168,-410.56921348107164,-541.8889201911625,-420.679663114002,-1234.3007694186115],"yaxis":"y","type":"scatter"},{"customdata":[["pixisepoch","kei"]],"hovertemplate":"model=%{customdata[1]}\u003cbr\u003e0=%{x}\u003cbr\u003e1=%{y}\u003cbr\u003ecarname=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"kei","marker":{"color":"#B6E880","symbol":"circle"},"mode":"markers","name":"kei","orientation":"v","showlegend":true,"x":[-3233661.527073698],"xaxis":"x","y":[-399.08386335814356],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"0"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"1"}},"legend":{"title":{"text":"model"},"tracegroupgap":0},"margin":{"t":60}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('4bff50c4-92a2-4832-b152-50acd13e05e6');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div></div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="markdown-notebooks.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Notebooks with MyST Markdown</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>